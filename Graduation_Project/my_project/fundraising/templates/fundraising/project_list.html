{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Projects - CrowdFund</title>
    <link rel="stylesheet" href="{% static 'fundraising/style.css' %}">
    <link rel="icon" type="image/svg+xml" href="{% static 'fundraising/favicon.svg' %}">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav-container">
            <a href="{% url 'home' %}" class="logo">
                <i class="fas fa-hand-holding-heart"></i>
                CrowdFund
            </a>
            <ul class="nav-links">
                <li><a href="{% url 'home' %}">Home</a></li>
                <li><a href="{% url 'project_list' %}">Projects</a></li>
                {% if user.is_authenticated %}
                    <li><a href="{% url 'create_project' %}">Create Project</a></li>
                    <li><a href="{% url 'logout' %}">Logout</a></li>
                {% else %}
                    <li><a href="{% url 'login' %}">Login</a></li>
                    <li><a href="{% url 'register' %}">Register</a></li>
                {% endif %}
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Search Section -->
        <section class="card">
            <h2><i class="fas fa-search"></i> Discover Projects</h2>
            <form method="GET" style="display: flex; gap: 1rem; align-items: end; flex-wrap: wrap;">
                <div class="form-group" style="flex: 1; min-width: 200px;">
                    <label for="date">Search by Date:</label>
                    <input type="date" name="date" id="date" value="{{ request.GET.date }}">
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-search"></i> Search
                </button>
                {% if request.GET.date %}
                    <a href="{% url 'project_list' %}" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Clear
                    </a>
                {% endif %}
            </form>
        </section>

        <!-- Projects Grid -->
        <section class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2><i class="fas fa-list"></i> All Projects ({{ projects.count }})</h2>
                {% if user.is_authenticated %}
                    <a href="{% url 'create_project' %}" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Create New Project
                    </a>
                {% endif %}
            </div>
            
            <div class="projects-grid">
                {% for project in projects %}
                    <div class="project-card">
                        <div class="project-image">
                            {% if project.image %}
                                <img src="{{ project.image.url }}" 
                                     alt="{{ project.title }}" 
                                     style="width: 100%; height: 200px; object-fit: cover; border-radius: 10px; margin-bottom: 1rem;">
                            {% else %}
                                <img src="https://images.unsplash.com/photo-1557804506-669a67965ba0?w=400&h=250&fit=crop&crop=center" 
                                     alt="{{ project.title }}" 
                                     style="width: 100%; height: 200px; object-fit: cover; border-radius: 10px; margin-bottom: 1rem;">
                            {% endif %}
                        </div>
                        <h3>{{ project.title }}</h3>
                        <p>{{ project.details|truncatewords:25 }}</p>
                        
                        <div class="project-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 75%;"></div>
                            </div>
                            <div class="progress-text">75% of ${{ project.target }} raised</div>
                        </div>
                        
                        <div class="project-meta">
                            <span class="project-owner">
                                <i class="fas fa-user"></i> {{ project.owner.username }}
                            </span>
                            <span class="project-date">
                                <i class="fas fa-calendar"></i> {{ project.start_date|date:"M d, Y" }}
                            </span>
                        </div>
                        
                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            {% if user == project.owner %}
                                <a href="{% url 'edit_project' project.id %}" class="btn btn-secondary" style="flex: 1; text-align: center; padding: 8px 16px; font-size: 0.9rem;">
                                    <i class="fas fa-edit"></i> Edit
                                </a>
                                <a href="{% url 'delete_project' project.id %}" class="btn btn-secondary" style="flex: 1; text-align: center; padding: 8px 16px; font-size: 0.9rem; background: #dc3545; color: white; border-color: #dc3545;" onclick="return confirm('Are you sure you want to delete this project?')">
                                    <i class="fas fa-trash"></i> Delete
                                </a>
                            {% else %}
                                <button class="btn btn-primary" style="flex: 1; text-align: center; padding: 8px 16px; font-size: 0.9rem;">
                                    <i class="fas fa-heart"></i> Support
                                </button>
                            {% endif %}
                        </div>
                    </div>
                {% empty %}
                    <div class="project-card" style="grid-column: 1 / -1; text-align: center;">
                        <i class="fas fa-search" style="font-size: 3rem; color: #667eea; margin-bottom: 1rem;"></i>
                        <h3>No Projects Found</h3>
                        <p>{% if request.GET.date %}No projects found for the selected date.{% else %}No projects have been created yet.{% endif %}</p>
                        {% if user.is_authenticated %}
                            <a href="{% url 'create_project' %}" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Create First Project
                            </a>
                        {% else %}
                            <a href="{% url 'register' %}" class="btn btn-primary">
                                <i class="fas fa-user-plus"></i> Join and Create
                            </a>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <h3><i class="fas fa-hand-holding-heart"></i> CrowdFund</h3>
            <p>Empowering dreams, one project at a time.</p>
            <p>&copy; 2024 CrowdFund. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Add some interactive features
        document.addEventListener('DOMContentLoaded', function() {
            // Animate project cards on scroll
            const projectCards = document.querySelectorAll('.project-card');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.animation = 'fadeInUp 0.6s ease';
                    }
                });
            });
            
            projectCards.forEach(card => observer.observe(card));
        });
    </script>
</body>
</html> 